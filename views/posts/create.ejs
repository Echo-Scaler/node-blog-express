<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>New Story - Byte & Beyond</title>
    <link rel="stylesheet" href="/css/style.css" />
  </head>
  <body>
    <header class="editor-header">
      <div style="display: flex; align-items: center; gap: 16px">
        <a
          href="/dashboard"
          class="logo"
          style="text-decoration: none; font-size: 18px"
          >Byte & Beyond</a
        >
        <div class="draft-status">
          <div class="draft-dot saved"></div>
          <span>Drafting</span>
        </div>
      </div>
      <div style="display: flex; gap: 12px; align-items: center">
        <span
          id="user-info"
          style="
            font-size: 14px;
            font-weight: 600;
            color: var(--text-secondary);
            margin-right: 12px;
          "
        ></span>
        <button
          type="submit"
          form="create-post-form"
          class="btn btn-primary"
          style="padding: 8px 24px"
        >
          Publish
        </button>
      </div>
    </header>

    <main>
      <div class="editor-layout">
        <div
          style="margin-bottom: 24px; display: flex; justify-content: flex-end"
        >
          <a href="/dashboard" class="btn btn-ghost" style="padding-left: 0">
            <svg
              width="20"
              height="20"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
            >
              <polyline points="15 18 9 12 15 6"></polyline>
            </svg>
            Back to Dashboard
          </a>
        </div>
        <form id="create-post-form">
          <input
            type="text"
            id="title"
            name="title"
            placeholder="Title"
            class="editor-title"
            required
            maxlength="200"
            autofocus
          />

          <div class="form-group" style="margin-bottom: 32px">
            <label
              for="image"
              style="
                display: block;
                width: 100%;
                height: 200px;
                border: 2px dashed var(--border-light);
                border-radius: var(--radius-md);
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: center;
                cursor: pointer;
                transition: all 0.2s;
                background: #f8fafc;
                overflow: hidden;
                position: relative;
              "
              class="image-upload-label"
            >
              <div id="upload-placeholder" style="text-align: center">
                <svg
                  width="48"
                  height="48"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="var(--text-secondary)"
                  stroke-width="1.5"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  style="margin-bottom: 12px"
                >
                  <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                  <circle cx="8.5" cy="8.5" r="1.5"></circle>
                  <polyline points="21 15 16 10 5 21"></polyline>
                </svg>
                <div
                  style="
                    font-weight: 600;
                    color: var(--text-secondary);
                    font-size: 14px;
                  "
                >
                  Click to upload cover image
                </div>
                <div
                  style="
                    font-size: 12px;
                    color: var(--text-secondary);
                    margin-top: 4px;
                    opacity: 0.7;
                  "
                >
                  Recommended: 1200x630px
                </div>
              </div>
              <img
                id="image-preview"
                src=""
                alt="Preview"
                style="
                  width: 100%;
                  height: 100%;
                  object-fit: cover;
                  display: none;
                "
              />
            </label>
            <input
              type="file"
              id="image"
              name="image"
              accept="image/*"
              style="display: none"
              onchange="previewImage(this)"
            />
          </div>

          <textarea
            id="content"
            name="content"
            placeholder="Tell your story..."
            class="editor-content"
            required
          ></textarea>

          <script>
            function previewImage(input) {
              const preview = document.getElementById("image-preview");
              const placeholder = document.getElementById("upload-placeholder");

              if (input.files && input.files[0]) {
                const reader = new FileReader();

                reader.onload = function (e) {
                  preview.src = e.target.result;
                  preview.style.display = "block";
                  placeholder.style.display = "none";
                };

                reader.readAsDataURL(input.files[0]);
              } else {
                preview.src = "";
                preview.style.display = "none";
                placeholder.style.display = "block";
              }
            }
          </script>

          <div class="editor-settings">
            <h2 style="font-size: 18px; margin-bottom: 24px; font-weight: 800">
              Story Settings
            </h2>

            <div class="form-group">
              <label class="editor-label">Category</label>
              <select
                id="categoryId"
                name="categoryId"
                class="form-control"
                required
                style="border-radius: 12px; padding: 14px"
              >
                <option value="">Select a category</option>
                <!-- Categories will be loaded dynamically -->
              </select>
            </div>

            <div class="form-group">
              <label class="editor-label">Tags</label>
              <input
                type="text"
                id="tags"
                name="tags"
                placeholder="Add some keywords..."
                class="form-control"
                style="border-radius: 12px; padding: 14px"
              />
            </div>

            <div class="form-group">
              <label class="editor-label">Short Preview</label>
              <textarea
                id="excerpt"
                name="excerpt"
                placeholder="What is this story about?"
                rows="3"
                maxlength="300"
                class="form-control"
                style="border-radius: 12px; padding: 14px; height: auto"
              ></textarea>
            </div>

            <div style="display: none">
              <select id="status" name="status">
                <option value="published" selected>Published</option>
                <option value="draft">Draft</option>
              </select>
            </div>
          </div>
        </form>

        <div id="message" style="margin-top: 40px"></div>
      </div>
    </main>

    <script src="/js/auth.js"></script>
    <script src="/js/create-post.js"></script>
  </body>
</html>
